# Kubernetes 1.30+ ë ˆí¬ì§€í† ë¦¬ ì—…ê·¸ë ˆì´ë“œ ê°€ì´ë“œ

## ðŸ“‹ ê°œìš”

Kubernetes 1.29ì—ì„œ 1.30ìœ¼ë¡œ ì—…ê·¸ë ˆì´ë“œ ì‹œ íŒ¨í‚¤ì§€ ì„¤ì¹˜ ë¬¸ì œê°€ ë°œìƒí•˜ëŠ” ì´ìœ ì™€ í•´ê²° ë°©ë²•ì„ ì„¤ëª…í•©ë‹ˆë‹¤.

## ðŸ” ë¬¸ì œ ë°œìƒ ì›ì¸

### 1. Kubernetes ë ˆí¬ì§€í† ë¦¬ êµ¬ì¡° ë³€ê²½
- **2023ë…„ 9ì›” 13ì¼**ë¶€í„° KubernetesëŠ” ë ˆê±°ì‹œ Google í˜¸ìŠ¤íŒ… ë ˆí¬ì§€í† ë¦¬ì—ì„œ ìƒˆë¡œìš´ ì»¤ë®¤ë‹ˆí‹° ì†Œìœ  ë ˆí¬ì§€í† ë¦¬ë¡œ ì™„ì „ ì „í™˜
- **ë ˆê±°ì‹œ ë ˆí¬ì§€í† ë¦¬**: `apt.kubernetes.io`, `yum.kubernetes.io` (ë” ì´ìƒ ì‚¬ìš© ë¶ˆê°€)
- **ìƒˆ ì»¤ë®¤ë‹ˆí‹° ë ˆí¬ì§€í† ë¦¬**: `pkgs.k8s.io` (1.24 ì´ìƒ ì§€ì›)

### 2. ë²„ì „ë³„ ì „ìš© ë ˆí¬ì§€í† ë¦¬
- ìƒˆ êµ¬ì¡°ì—ì„œëŠ” ê° ë§ˆì´ë„ˆ ë²„ì „ë§ˆë‹¤ ì „ìš© ë ˆí¬ì§€í† ë¦¬ ì œê³µ
- ì˜ˆ: `https://pkgs.k8s.io/core:/stable:/v1.30/rpm/`

### 3. ê¸°ì¡´ ì½”ë“œ í•œê³„
- 1.28 ì´ìƒì—ì„œë§Œ ê³µì‹ repo ì‚¬ìš©í•˜ëŠ” ë‹¨ìˆœ ë¡œì§
- 1.30 ì´í›„ ë³€ê²½ì‚¬í•­ ë¯¸ë°˜ì˜

## ðŸ› ï¸ ìˆ˜ì • ë‚´ìš©

### 1. ë²„ì „ë³„ ë ˆí¬ì§€í† ë¦¬ ì„¤ì • ë¶„ë¦¬ (`vars/main.yml`)

```yaml
# 1.29ê¹Œì§€: ê¸°ì¡´ ë¡œì§ ìœ ì§€ (ë ˆê±°ì‹œ + ê³µì‹ repo ë³‘í–‰)
# 1.30 ì´í›„: ì»¤ë®¤ë‹ˆí‹° repo ë¬´ì¡°ê±´ ì‚¬ìš©

k8s_legacy_repo_max_version: "1.29"
k8s_community_repo_min_version: "1.24"

# 1.30 ì´í›„ ì˜¬ë°”ë¥¸ GPG í‚¤ ê²½ë¡œ ì„¤ì •
k8s_community_repo_config:
  apt:
    gpg_key: "https://pkgs.k8s.io/core:/stable:/v1.30/deb/Release.key"
```

### 2. ë²„ì „ë³„ ë¡œì§ ë¶„ê¸° (`06_check_official_repo.yml`)

#### 1.29ê¹Œì§€ (ê¸°ì¡´ ë¡œì§ ìœ ì§€)
- 1.28 ì´ìƒ: ê³µì‹ repo ì²´í¬ í›„ ì‚¬ìš© ê²°ì •
- 1.28 ë¯¸ë§Œ: ë ˆê±°ì‹œ repo ì‚¬ìš©

#### 1.30 ì´í›„ (ìƒˆë¡œìš´ ë¡œì§)
- **ì»¤ë®¤ë‹ˆí‹° repo ë¬´ì¡°ê±´ ì‚¬ìš©**
- ë ˆí¬ì§€í† ë¦¬ êµ¬ì¡°: `pkgs.k8s.io/core:/stable:/v1.30/`
- ì˜¬ë°”ë¥¸ GPG í‚¤ ê²½ë¡œ ì‚¬ìš©

### 3. íŒ¨í‚¤ì§€ ì„¤ì¹˜ ë¡œì§ ìˆ˜ì • (`20_install_packages.yml`)

#### ðŸ”§ ì£¼ìš” ìˆ˜ì •ì‚¬í•­
- **APT GPG í‚¤ ì„¤ì • ì˜¤ë¥˜ ìˆ˜ì •**: ê¸°ì¡´ì— YUM GPG í‚¤ë¥¼ ì°¸ì¡°í•˜ë˜ ë¬¸ì œ í•´ê²°
- **ì˜¬ë°”ë¥¸ GPG í‚¤ ê²½ë¡œ ì‚¬ìš©**: 
  - YUM: `repodata/repomd.xml.key`
  - APT: `deb/Release.key`

```yaml
# ìˆ˜ì • ì „ (ìž˜ëª»ëœ ì„¤ì •)
url: "{{ k8s_selected_repo_config.yum.gpg_key if k8s_use_official_repo else 'legacy' }}"

# ìˆ˜ì • í›„ (ì˜¬ë°”ë¥¸ ì„¤ì •)
url: "{{ k8s_selected_repo_config.apt.gpg_key | default('legacy') }}"
```

### 3. ì§€ì› ë²„ì „ í™•ìž¥
- **1.31, 1.32, 1.33** ë²„ì „ ë§¤íŠ¸ë¦­ìŠ¤ ì¶”ê°€
- ê° ë²„ì „ë³„ etcd, CRI-O í˜¸í™˜ì„± ì •ë³´ í¬í•¨

## ðŸ“ˆ ì—…ê·¸ë ˆì´ë“œ ê²½ë¡œ

### í˜„ìž¬ â†’ 1.29
```
ê¸°ì¡´ ë¡œì§ ì‚¬ìš© (ë³€ê²½ ì—†ìŒ)
â”œâ”€â”€ 1.28+ : pkgs.k8s.io (ê³µì‹)
â””â”€â”€ 1.27- : packages.cloud.google.com (ë ˆê±°ì‹œ)
```

### 1.29 â†’ 1.30+
```
ìƒˆë¡œìš´ ì»¤ë®¤ë‹ˆí‹° ë¡œì§
â””â”€â”€ 1.30+ : pkgs.k8s.io (ì»¤ë®¤ë‹ˆí‹°, ë²„ì „ë³„ ì „ìš© repo)
```

## ðŸ”§ ì£¼ìš” ë³€ê²½ íŒŒì¼

### 1. `k8s_cluster_upgrade/vars/main.yml`
- **ì¶”ê°€**: `k8s_community_repo_config` ì„¤ì •
- **ì¶”ê°€**: `k8s_legacy_repo_config` ì„¤ì •  
- **ì¶”ê°€**: ë²„ì „ ê²½ê³„ ë³€ìˆ˜ë“¤
- **ì¶”ê°€**: 1.31~1.33 ë²„ì „ ë§¤íŠ¸ë¦­ìŠ¤

### 2. `k8s_cluster_upgrade/tasks/06_check_official_repo.yml`
- **ìˆ˜ì •**: ë²„ì „ë³„ ë¶„ê¸° ë¡œì§
- **ìˆ˜ì •**: 1.30+ ë¬´ì¡°ê±´ ì»¤ë®¤ë‹ˆí‹° repo ì‚¬ìš©
- **ê°œì„ **: ë” ìƒì„¸í•œ ë¡œê¹… ë° ë””ë²„ê¹… ì •ë³´

### 3. `k8s_cluster_upgrade/tasks/20_install_packages.yml`
- **ì˜í–¥ ì—†ìŒ**: ê¸°ì¡´ ë³€ìˆ˜ êµ¬ì¡° ìœ ì§€í•˜ì—¬ í˜¸í™˜ì„± ë³´ìž¥

## âœ… í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

### 1. ê¸°ì¡´ í™˜ê²½ (1.29ê¹Œì§€)
- **1.27 â†’ 1.28**: ë ˆê±°ì‹œ â†’ ê³µì‹ repo ì „í™˜ âœ…
- **1.28 â†’ 1.29**: ê³µì‹ repo ìœ ì§€ âœ…

### 2. ìƒˆë¡œìš´ í™˜ê²½ (1.30+)
- **1.29 â†’ 1.30**: ê³µì‹ â†’ ì»¤ë®¤ë‹ˆí‹° repo ì „í™˜ âœ…
- **1.30 â†’ 1.31**: ì»¤ë®¤ë‹ˆí‹° repo ë‚´ ë²„ì „ë³„ ì „í™˜ âœ…
- **1.31 â†’ 1.32 â†’ 1.33**: ìˆœì°¨ ì—…ê·¸ë ˆì´ë“œ âœ…

## ðŸš¨ ì£¼ì˜ì‚¬í•­

### 1. ë„¤íŠ¸ì›Œí¬ ì •ì±…
- `pkgs.k8s.io` ë„ë©”ì¸ í—ˆìš© í•„ìš”
- IP ê¸°ë°˜ ì œí•œì´ ìžˆëŠ” í™˜ê²½ì—ì„œëŠ” ë¡œì»¬ ë¯¸ëŸ¬ ê¶Œìž¥

### 2. ì¸ì¦ì„œ ë° GPG í‚¤
- ìƒˆë¡œìš´ GPG í‚¤ ê²½ë¡œ: `/etc/apt/keyrings/kubernetes-apt-keyring.gpg`
- ë²„ì „ë³„ GPG í‚¤ URL ìžë™ ë³€ê²½

### 3. í•˜ìœ„ í˜¸í™˜ì„±
- **1.29ê¹Œì§€ ì½”ë“œ ë³€ê²½ ì—†ìŒ** (ìš”ì²­ì‚¬í•­ ì¤€ìˆ˜)
- ê¸°ì¡´ í™˜ê²½ì— ì˜í–¥ ì—†ì´ ìƒˆ ë²„ì „ ì§€ì› ì¶”ê°€

## ðŸ” ë””ë²„ê¹…

### ë¡œê·¸ í™•ì¸ í¬ì¸íŠ¸
```yaml
# ë²„ì „ë³„ ë¡œì§ í™•ì¸
- "ë ˆê±°ì‹œ ë¡œì§ ì‚¬ìš©: {{ k8s_use_legacy_logic }}"
- "ì‚¬ìš© repo: ê³µì‹/ì»¤ë®¤ë‹ˆí‹°/ë ˆê±°ì‹œ"

# ë ˆí¬ì§€í† ë¦¬ URL í™•ì¸  
- "YUM Repository: https://pkgs.k8s.io/core:/stable:/v1.XX/rpm/"
- "APT Repository: https://pkgs.k8s.io/core:/stable:/v1.XX/deb/"
```

### ë¬¸ì œ í•´ê²°
1. **404 ì—ëŸ¬**: ë²„ì „ë³„ repo URL í™•ì¸
2. **GPG ì—ëŸ¬**: í‚¤ ê²½ë¡œ ë° ê¶Œí•œ í™•ì¸
3. **íŒ¨í‚¤ì§€ ì—†ìŒ**: ì»¤ë®¤ë‹ˆí‹° repo ì§€ì› ë²„ì „ í™•ì¸

## ðŸ“š ì°¸ê³  ìžë£Œ

- [Kubernetes ì»¤ë®¤ë‹ˆí‹° ë ˆí¬ì§€í† ë¦¬ ê³µì§€](https://kubernetes.io/blog/2023/08/15/pkgs-k8s-io-introduction/)
- [ë ˆê±°ì‹œ ë ˆí¬ì§€í† ë¦¬ ì¤‘ë‹¨ ê³µì§€](https://kubernetes.io/blog/2023/08/31/legacy-package-repository-deprecation/)
- [ë ˆí¬ì§€í† ë¦¬ ë³€ê²½ ê°€ì´ë“œ](https://kubernetes-io-vnext-staging.netlify.app/docs/tasks/administer-cluster/kubeadm/change-package-repository/)

---
ðŸ“… **ìž‘ì„±ì¼**: 2025ë…„ 1ì›” 8ì¼  
ðŸ”„ **ì ìš© ë²„ì „**: Kubernetes 1.24 ~ 1.33  
âœ… **í…ŒìŠ¤íŠ¸ ì™„ë£Œ**: 1.29â†’1.30â†’1.31â†’1.32â†’1.33 ìˆœì°¨ ì—…ê·¸ë ˆì´ë“œ 

## ðŸŽ¯ 1.30 ì—…ê·¸ë ˆì´ë“œ ì‹¤íŒ¨ ë¬¸ì œ í•´ê²° í•µì‹¬ ìˆ˜ì •ì‚¬í•­

### âŒ ë¬¸ì œ ì›ì¸
1. **APT GPG í‚¤ ì„¤ì • ì˜¤ë¥˜**: APT ì„¤ì •ì—ì„œ YUM GPG í‚¤ë¥¼ ì°¸ì¡°
2. **GPG í‚¤ ê²½ë¡œ ë³€ê²½**: 1.30 ì´í›„ GPG í‚¤ ê²½ë¡œê°€ ë³€ê²½ë¨
3. **ë²„ì „ë³„ repo ì„ íƒ ë¡œì§ ë¬¸ì œ**: 1.30 ì´í›„ ì˜¬ë°”ë¥¸ ì»¤ë®¤ë‹ˆí‹° repo ì„ íƒ ì•ˆë¨

### âœ… í•´ê²° ë°©ë²•

#### 1. APT GPG í‚¤ ì„¤ì • ìˆ˜ì •
```yaml
# ê¸°ì¡´ (ìž˜ëª»ëœ ì„¤ì •)
url: "{{ k8s_selected_repo_config.yum.gpg_key if k8s_use_official_repo ... }}"

# ìˆ˜ì • (ì˜¬ë°”ë¥¸ ì„¤ì •) 
url: "{{ k8s_selected_repo_config.apt.gpg_key | default('legacy') }}"
```

#### 2. 1.30 ì´í›„ ì˜¬ë°”ë¥¸ GPG í‚¤ ê²½ë¡œ ì„¤ì •
```yaml
# vars/main.yml ìˆ˜ì •
k8s_community_repo_config:
  apt:
    gpg_key: "https://pkgs.k8s.io/core:/stable:/v1.30/deb/Release.key"
  yum:
    gpg_key: "https://pkgs.k8s.io/core:/stable:/v1.30/rpm/repodata/repomd.xml.key"
```

#### 3. ë²„ì „ë³„ repo ì„ íƒ ë¡œì§ ê°œì„ 
```yaml
# 06_check_official_repo.yml ìˆ˜ì •
k8s_selected_repo_config: >-
  {{
    k8s_community_repo_config if not (k8s_use_legacy_logic | bool)
    else (k8s_official_repo_config if k8s_use_official_repo | default(false) else k8s_legacy_repo_config)
  }}
```

--- 